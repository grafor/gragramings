<!DOCTYPE html>
<html>
<head>
<style>
  #cube {
  width: 150px;
  height: 500px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform-style: preserve-3d;
  transform: translate(-50%, -50%);
}
.face {
  position: absolute;
  width: 200px;
  height: 200px;
}
#front {
  background-image: url('https://media.tenor.com/nBt6RZkFJh8AAAAi/never-gonna.gif');
  transform: translateZ(100px);
}
#back {
  background-image: url('https://media.tenor.com/nBt6RZkFJh8AAAAi/never-gonna.gif');
  transform: rotateY(180deg) translateZ(100px);
}
#left {
  background-image: url('https://media.tenor.com/nBt6RZkFJh8AAAAi/never-gonna.gif');
  transform: rotateY(-90deg) translateZ(100px);
}
#right {
  background-image: url('https://media.tenor.com/nBt6RZkFJh8AAAAi/never-gonna.gif');
  transform: rotateY(90deg) translateZ(100px);
}
#top {
  background-color: green;
  transform: rotateX(90deg) translateZ(100px);
}
#bottom {
  background-image: url('https://media.tenor.com/nBt6RZkFJh8AAAAi/never-gonna.gif');
  transform: rotateX(-90deg) translateZ(100px);
}
</style>
</head>
<body>

<div id="cube">
  <div class="face" id="front"></div>
  <div class="face" id="back"></div>
  <div class="face" id="left"></div>
  <div class="face" id="right"></div>
  <div class="face" id="top"></div>
  <div class="face" id="bottom"></div>
</div>

<script>
let cube = document.querySelector('#cube');
let x = Math.random() * 360 - 180;
let y = Math.random() * 360 - 180;

cube.style.transform = `rotateX(${x}deg) rotateY(${y}deg)`;

document.onkeydown = function(e) {
    if (e.keyCode == '37') {
        y -=5;
    } else if (e.keyCode == '39') {
        y +=5;
    } else if (e.keyCode == '38') {
        x -=5;
    } else if (e.keyCode == '40') {
        x +=5;
    }
    cube.style.transform = `rotateX(${x}deg) rotateY(${y}deg)`;
}

let isDragging = false;
let currentX;
let currentY;
let initialX;
let initialY;
let xOffset = y * -1;
let yOffset = x;

cube.addEventListener("mousedown", dragStart, false);
cube.addEventListener("mouseup", dragEnd, false);
cube.addEventListener("mousemove", drag, false);

cube.addEventListener("touchstart", dragStart, false);
cube.addEventListener("touchend", dragEnd, false);
cube.addEventListener("touchmove", drag, false);

function dragStart(e) {
    if (e.type === "touchstart") {
        initialX = e.touches[0].clientX - xOffset;
        initialY = e.touches[0].clientY - yOffset;
    } else {
        initialX = e.clientX - xOffset;
        initialY = e.clientY - yOffset;
    }

    if (e.target === cube) {
        isDragging = true;
    }
}

function dragEnd(e) {
    initialX = currentX;
    initialY = currentY;

    isDragging = false;
}

function drag(e) {
    if (isDragging) {
        e.preventDefault();
        if (e.type === "touchmove") {
            currentX = e.touches[0].clientX - initialX;
            currentY = e.touches[0].clientY - initialY; 
        } else {
            currentX = e.clientX - initialX; 
            currentY = e.clientY - initialY; 
        }
      
xOffset = currentX; 
yOffset = currentY;

setTranslate(currentX, currentY, cube);
}
}

function setTranslate(xPos, yPos, el) {
el.style.transform = "rotateX(" + (yPos * -1) + "deg) rotateY(" + xPos + "deg)";
}
  
  function randomColor() {
    return '#' + Math.floor(Math.random() * 16777215).toString(16);
}

setInterval(function() {
    document.querySelector('#top').style.backgroundColor = randomColor();
}, 2000);
  
</script>

</body>
</html>
